!function(a,b,$,c){"use strict";function d(){this._events={}}c=c||{},d.prototype.hasEventListener=function(a){return!!this._events[a]},d.prototype.addEventListener=function(a,b){if(this.hasEventListener(a)){var c=this._events[a];for(var d in c)if(c[d]===b)return;c.push(b)}else this._events[a]=[b];return this},d.prototype.removeEventListener=function(a,b){if(this.hasEventListener(a)){for(var c,d=this._events[a],e=d.length;e--;)d[e]===b&&(c=e);return d.splice(c,1),this}},d.prototype.fireEvent=function(a,b){if(this.hasEventListener(a)){var c=this._events[a],d=$.merge([],c),e=$.merge([],arguments);e.splice(0,2);for(var f in d)d[f].apply(b||this,e)}},c.EventDispatcher=d,a.kokki=c}(this,document,jQuery,this.kokki),function(a,b,$,c){"use strict";function d(a){this.interval=a,this.prevTime=0,this.timer=function(){}}c=c||{},d.prototype.exec=function(a){var b=+new Date,c=b-this.prevTime;clearTimeout(this.timer),c>=this.interval?(this.prevTime=b,a()):this.timer=setTimeout(a,this.interval)},c.Throttle=d,a.kokki=c}(this,document,jQuery,this.kokki),function(a,b,$,c){"use strict";function d(a){a?this.src="https://spreadsheets.google.com/feeds/list/"+a+"/od6/public/basic?alt=json-in-script":console.log("[ERROR] id is not defined")}c=c||{};var e,f;e=d.prototype.constructor,d.prototype=new c.EventDispatcher,d.prototype.constructor=e,d.prototype.exec=function(){$("head").append($(document.createElement("script")).attr("src",this.src))},d.getInstance=function(a){return f||(f=new d(a)),f},c.GetCountryData=d,a.kokki=c}(this,document,jQuery,this.kokki);var gdata={io:{}},originalConstructor;gdata.io.handleScriptLoaded=function(a){"use strict";var b,c=a.feed.entry,d=/カラーコード: (.*?),/,e=/国名英語表記: (.*?),/,f=/placeid: (.*?),/,g=/画像url: (.*?),/,h=/緯度経度: (.*?)$/,i=/(#\w*)/g,j=window.kokki;j.colorList=[],j.countryList=[];for(var k=0;k<c.length;k++)j.countryList[k]={name:c[k].title.$t,color:c[k].content.$t.match(d)[1].split("#").splice(1,3),place_id:c[k].content.$t.match(f)[1],nameEng:c[k].content.$t.match(e)[1],imgPath:c[k].content.$t.match(g)[1],latlng:c[k].content.$t.match(h)[1].split(":")},b=c[k].content.$t.match(i),j.colorList=j.colorList.concat(b);gdata.io.handleScriptLoaded.prototype.fireEvent("LOADED")},originalConstructor=gdata.io.handleScriptLoaded.prototype.constructor,gdata.io.handleScriptLoaded.prototype=new window.kokki.EventDispatcher,gdata.io.handleScriptLoaded.prototype.constructor=originalConstructor,function(a,b,$,c){"use strict";function d(){}c=c||{};var e,f,g="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=6c91ca1e147aafc84b8f0047781440eb&sort=interestingness-desc&place_id=#{place_id}&format=json";e=d.prototype.constructor,d.prototype=new c.EventDispatcher,d.prototype.constructor=e,d.prototype.exec=function(b){var c=this;$.ajax({type:"get",dataType:"jsonp",url:g.replace("#{place_id}",b)}),a.jsonFlickrApi=function(a){c.fireEvent("PHOTO_LOADED",c,a.photos.photo)}},d.getInstance=function(a){return f||(f=new d(a)),f},c.GetFlickrData=d,a.kokki=c}(this,document,jQuery,this.kokki),function(a,b,$,c){"use strict";function d(){}c=c||{};var e,f;e=d.prototype.constructor,d.prototype=new c.EventDispatcher,d.prototype.constructor=e,d.prototype.layer=function(){function a(a){d[a].on("click",function(){c.fireEvent("STOP",c,$(this).attr("class"))})}var b,c=this,d=[$(".firstLayer"),$(".secondLayer"),$(".thirdLayer")];for(b=0;b<d.length;b++)a(b)},d.prototype.reset=function(){var a=this;$(".moreBtn").on("click",function(){a.fireEvent("RESET")})},d.getInstance=function(){return f||(f=new d),f},c.ClickHandler=d,a.kokki=c}(this,document,jQuery,this.kokki),function(a,b,$,c){"use strict";function d(){}c=c||{};var e,f,g=$(".slotContainer");e=d.prototype.constructor,d.prototype=new c.EventDispatcher,d.prototype.constructor=e,d.prototype.exec=function(){$(window).on("load resize",function(){g.css({height:$(this).height()})})},d.getInstance=function(){return f||(f=new d),f},c.ResizeHandler=d,a.kokki=c}(this,document,jQuery,this.kokki),function(a,b,$,c){"use strict";function d(a){this.INTERVAL=a||10}c=c||{};var e,f,g=$(".flag").find("img"),h=[$(".firstLayer"),$(".secondLayer"),$(".thirdLayer")],i=h.length,j=$("#filter");e=d.prototype.constructor,d.prototype=new c.EventDispatcher,d.prototype.constructor=e,d.prototype.exec=function(){function a(){if(e===b.INTERVAL){for(j=0;i>j;j++)h[j].css({"background-color":c.colorList[(d+g[j])%f]});e=0,d++,d===f&&(d=0)}e++,window.requestAnimationFrame(a)}var b=this,d=0,e=0,f=c.colorList.length,g=[0,4,7],j=0;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame,window.requestAnimationFrame(a)},d.prototype.stop=function(a){function b(){g.attr({src:c.countryList[c.nextNum].imgPath}),g.get(0).complete?d():g.on("load",d)}function d(){setTimeout(function(){o.fireEvent("SLOT_FINISHED",o,m,n),j.addClass("hide")},q)}var e,f,k,l,m,n,o=this,p=["firstLayer","secondLayer","thirdLayer"],q=1e3;for(f=0;i>f;f++)if(h[f].attr("class")===a){e=f;break}k=h[e],h.splice(e,1),i--,k.addClass("selected"),k.css({"background-color":"#"+c.countryList[c.nextNum].color[p.indexOf(a)]}),0===i&&(l=new Image,l.onload=function(){m=l.width,n=l.height,b()},l.src=c.countryList[c.nextNum].imgPath)},d.prototype.reset=function(){h=[$(".firstLayer"),$(".secondLayer"),$(".thirdLayer")],i=h.length},d.getInstance=function(a){return f||(f=new d(a)),f},c.Slot=d,a.kokki=c}(this,document,jQuery,this.kokki),function(a,b,$,c){"use strict";c=c||{};var d=$(".slot"),e=$(".flag"),f=e.find("img"),g=$(".countryName"),h=$(".countryFlagWiki .sentence");c.showCountryContents=function(b,i,j){function k(){var b=1e3,d=new a.google.maps.LatLng(c.countryList[c.nextNum].latlng[0],c.countryList[c.nextNum].latlng[1]),e={center:d,zoom:3,mapTypeId:a.google.maps.MapTypeId.ROADMAP},f=new a.google.maps.Map(document.getElementById("map"),e);$("#map").addClass("show"),setTimeout(function(){new a.google.maps.Marker({animation:a.google.maps.Animation.DROP,position:d,map:f}),l(),m()},b)}function l(){g.css({"line-height":q/2+"px"}).text(c.countryList[c.nextNum].name).addClass("show")}function m(){$.ajax({type:"get",dataType:"jsonp",url:"http://ja.wikipedia.org/w/api.php?action=query&format=json&titles="+c.countryList[c.nextNum].name+"の国旗&prop=extracts&redirects=1&exchars=120&explaintext=1",success:function(a){for(var b in a.query.pages)if(a.query.pages.hasOwnProperty(b)&&a.query.pages[b].extract){h.css({width:p/2,height:q/2}).text(a.query.pages[b].extract).addClass("show");break}}})}var n,o,p=$(window).width(),q=$(window).height(),r=q/p,s=i/b,t=0;j=j||1e3,r>=s?(n=p/2,o=n*s,t=(q/2-o)/2):(o=q/2,n=o/s),d.animate({width:p/2,height:q/2,opacity:0},j,function(){d.css({display:"none"}),k()}),e.css({opacity:0}).animate({width:p/2,height:q/2,opacity:1},j),f.animate({width:n,height:o,marginTop:t},j)},a.kokki=c}(this,document,jQuery,this.kokki),function(a,b,$,c){"use strict";c=c||{};var d=['<p class="photo">','<img src="${photoSrc}" alt="写真">',"</p>"].join(""),e="https://farm#{farm}.staticflickr.com/#{server}/#{id}_#{secret}_n.jpg",f=$(".photoContainer"),g=$(".loader"),h=$(".moreBtn");c.showPhotos=function(a){var b,c,i,j=0,k=20,l=3,m=.025*$(window).width(),n=.3*$(window).width(),o=[],p=[],q=0,r=0,s=function(a){var b,c=0,d=a%l;for(p[a]=o[a].height*(n/o[a].width),b=d;k>b;b+=l)isNaN(p[b])||(c+=p[b]+m),k-l>b&&$(".photo").eq(b+l).css({top:c});c>q&&(q=c),r+=1,r===k&&(f.css({height:q+100,marginTop:100}),h.addClass("show"),g.removeClass("show"),window.scrollTo(0,0))},t=function(b){o[b]=new Image,o[b].onload=function(){s(b)},o[b].src=e.replace("#{farm}",a[b].farm).replace("#{server}",a[b].server).replace("#{id}",a[b].id).replace("#{secret}",a[b].secret)};for(g.addClass("show"),j=0;k>j;j++)t(j),b=j%l,0===b?i=m:1===b?i=n+2*m:2===b&&(i=2*n+3*m),c=d.replace("${photoSrc}",o[j].src),$(c).css({left:i,width:n}).appendTo(".photoContainer")},a.kokki=c}(this,document,jQuery,this.kokki),function(a,b,$,c){"use strict";c=c||{};var d=$(".photoContainer"),e=$(".countryName"),f=$(".countryFlagWiki .sentence"),g=$("#filter"),h=$("#map"),i=$(".slot"),j=$(".flag"),k=$(".flag img"),l=$(".moreBtn"),m=$(".firstLayer, .secondLayer, .thirdLayer");c.reset=function(){j.attr({src:"img/flag/white.jpg"}),i.css({display:"block",width:"100%",height:"100%",opacity:1}),j.css({width:"100%",height:"100%",opacity:0}),k.css({width:"inherit",height:"inherit",marginTop:0}).attr({src:"img/flag/white.jpg"}),h.empty(),e.text(""),f.text(""),d.empty().css({height:0,marginTop:0}),l.removeClass("show"),g.removeClass("hide"),m.removeClass("selected"),window.scrollTo(0,0)},a.kokki=c}(this,document,jQuery,this.kokki),function(a,b,$,c){"use strict";c=c||{},$(function(){function b(){c.nextNum=Math.floor(Math.random()*c.countryList.length)}var d=c.GetCountryData.getInstance("1LoCcYSg8J3SYsa2mYmieu9h5osw7by9GJc8F1OHIbZM"),e=c.GetFlickrData.getInstance(),f=c.Slot.getInstance(10),g=c.ClickHandler.getInstance(),h=c.ResizeHandler.getInstance();a.gdata.io.handleScriptLoaded.prototype.addEventListener("LOADED",function(){b(),f.exec()}),g.addEventListener("STOP",function(a){f.stop(a)}),g.addEventListener("RESET",function(){c.reset(),c.countryList.splice(c.nextNum,1),b(),f.reset()}),f.addEventListener("SLOT_FINISHED",function(a,b){c.showCountryContents(a,b),e.exec(c.countryList[c.nextNum].place_id)}),e.addEventListener("PHOTO_LOADED",function(a){c.showPhotos(a)}),d.exec(),g.layer(),g.reset(),h.exec()}),a.kokki=c}(this,document,jQuery,this.kokki);